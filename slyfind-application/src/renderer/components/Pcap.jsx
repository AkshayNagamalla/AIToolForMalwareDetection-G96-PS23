import { useState } from "react";
import Loader from "./Loader";
import Donut from "./Donut";

const Pcap = () => {
  const [resultDiv, setResultDiv] = useState("");
  const main = async (e) => {
    e.preventDefault();
    setResultDiv("");
    const input = document.querySelector(".file-input");
    input.style.display = "none";
    const loader = document.querySelector(".loader");
    loader.style.display = "block";
    let data;
    try {
      const file = document.getElementById("fileInput").files;
      const result = await window.api.capturecap(`"${file[0].path}"`);
      data = [
        {
          title: "Benign",
          value: result.benign,
        },
        {
          title: "Malicious",
          value: result.malicious,
        },
      ];
      loader.style.display = "none";
      setResultDiv(<Donut data={data} />);
      loader.style.display = "none";
      // input.style.display = "block";
      console.log("done model test");
    } catch (error) {
      console.error(error);
    }
  };
  return (
    <div className="pdf">
      <h2>Pcap Analysis</h2>
      <div className="file-input">
        <div className="ring">
          <i></i>
          <i></i>
          <i></i>
          <form id="fileForm" onSubmit={main}>
            <div className="login">
              <h3>Give Pcap File</h3>
              <div className="inputBx">
                <input
                  type="file"
                  id="fileInput"
                  name="fileInput"
                  accept=".pcap"
                />
              </div>
              <button type="submit">Submit</button>
            </div>
          </form>
        </div>
      </div>
      <Loader />
      <div className="result">{resultDiv}</div>
    </div>
  );
};

export default Pcap;
